{% extends "ductus_document.html" %}
{% load i18n %}
{% load jsonize %}
{% load urn %}

{% block head %}
{{ block.super }}
<script type="text/javascript" src="{{ ductus_media_prefix }}common/js/jQuery.jPlayer.2.0.0/jquery.jplayer.min.js"></script>
<script type="text/javascript">
var resource_json = {{ request.ductus.resource|resource_json }};
$(function () {
    var audio_mime_map = {
        "audio/mp4": "m4a",
        "audio/ogg": "oga"
    };

    var filetype = audio_mime_map[resource_json.resource.blob.mime_type];
    $("#ductus_audio").jPlayer({
        ready: function () {
            media_map = {};
            media_map[filetype] = resolve_urn(resource_json.href) + "?view=audio";
            $(this).jPlayer("setMedia", media_map);
            // autoplay
            $(this).jPlayer("play");
        },
        swfPath: ductus_media_prefix + "common/js/jQuery.jPlayer.2.0.0",
        supplied: filetype
    });
});
</script>
{% endblock %}

{% block content %}
{% with request.ductus.resource as resource %}
<div id="ductus_audio"></div>
<div id="jp_interface_1"><a href="javascript:void(0)" class="jp-play">play</a></div>
{% with resource.common.licenses as licenses %}
{% include "wiki/license_list.html" %}
{% endwith %}
{% endwith %}
{% endblock %}
