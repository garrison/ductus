{% extends "ductus_document.html" %}
{% load i18n %}
{% load jsonize %}
{% load static %}
{% load compress %}

{% block css %}
{{ block.super }}
{% compress css %}
<link type="text/css" href="{% static "ductus/common/css/token-input.css" %}" rel="stylesheet"/>
<link type="text/css" href="{% static "ductus/modules/textwiki/css/textwiki_editor.css" %}" rel="stylesheet"/>
<link type="text/css" href="{% static "ductus/modules/textwiki/css/textwiki.css" %}" rel="stylesheet"/>
<link rel="stylesheet" href="{% static "ductus/modules/textwiki/aloha/css/aloha.css" %}" type="text/css">
{% endcompress %}
{% endblock %}

{% block js %}
{{ block.super }}
{% compress js %}
<script type="text/javascript" src="{% static "ductus/common/js/jquery.blockUI.min.js" %}"></script>
<script type="text/javascript" src="{% static "ductus/common/js/jquery.tokeninput.js" %}"></script>
<script type="text/javascript" src="{% static "ductus/common/js/editing-widgets.js" %}"></script>
{% endcompress %}
{% compress js %}
<script type="text/javascript" src="{% static "ductus/modules/textwiki/js/textwiki_editor.js" %}"></script>
{% endcompress %}
<script type="text/javascript" src="{% static "ductus/modules/textwiki/aloha/lib/require.js" %}"></script>
<script type="text/javascript" src="{% static "ductus/modules/textwiki/aloha/lib/vendor/jquery-1.7.2.js" %}"></script>
<script type="text/javascript">
var Aloha = {
    settings: {
        jQuery: window.jQuery.noConflict(true),
        sidebar: { disabled: true },
        contentHandler: {
            initEditable: [ 'sanitize' ],
            getContents: [ 'sanitize' ],
            sanitize: 'relaxed', // relaxed, restricted, basic,
                allows: {
                    elements: [
                        'a', 'b', 'div', 'dl', 'dt', 'em',
                        'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'i', 'li', 'ol', 'p', 'pre', 'sub',
                        'sup', 'u', 'ul'],
                    attributes: {
                        'a'         : ['href'],
                     },
                    protocols: {
                        'a'         : {'href': ['ftp', 'http', 'https', 'mailto', '__relative__']}, // Sanitize.RELATIVE
                    }
                },
                handler: {
                    generic: {
                        transformFormattings: false // this will disable the transformFormattings method in the generic content handler
                    }
                }
            }
        }
};
</script>
<script type="text/javascript" src="{% static "ductus/modules/textwiki/aloha/lib/aloha.js" %}"
  data-aloha-plugins="common/ui,common/format,common/highlighteditables,common/link,common/contenthandler"></script>
{% endblock %}

{% block javascript %}
var resource_json = {{ resource_json|resource_json }};
var writable_directories = {{ writable_directories|jsonize }};
{% endblock %}

{% block content %}
<div id="textwiki-preview" class="ductus_textwiki_content"></div>
<div id="textwiki-editor"></div>
<div id="side_toolbar"></div>
<div id="editor-help">
<dl>
<dt>Emphasis</dt><dd>//<em>italics</em>//; **<strong>bold</strong>**; **//<em><strong>bold italics</strong></em>//**; //<em>mixed </em>**<em><strong>bold</strong>** and italics</em>//; </dd>
<dt>Horizontal Rule</dt><dd>---- </dd>
<dt>Force Linebreak</dt><dd>\\ </dd>
<dt>Headings</dt><dd>= Title 1 =; == Title 2 ==; === Title 3 ===; ==== Title 4 ====; ===== Title 5 =====. </dd>
<dt>Lists</dt><dd>* bullets; ** sub-bullets; # numbered items; ## numbered sub items. </dd>
<dt>Links</dt><dd>[[target]]; [[target|linktext]]. </dd>
<dt>Tables</dt><dd>|= header text | cell text | more cell text |; </dd>
</dl>
</div>
{% endblock %}
